# Component library template

This repository is meant to serve as a template when building web components library projects. The goal of this template
is to reduce time needed to set up new projects.

Our framework of choice is [StencilJS](https://stenciljs.com/).
We use [Storybook](https://storybook.js.org/) for developing components in isolation and documentation.

This component library comes with theming included and a simple example of light/dark theme.

### Prerequisites

Install volta. [Volta](https://volta.sh/) is used to manage our node, npm, yarn and stencil versions in a centralised way for our monorepo.

### Packages

This repository is a monorepo which consists of multiple packages that can be deployed independently.

The packages can be found under `packages` folder.
```
└── packages/
    ├── component-library
    ├── component-library-angular
    ├── component-library-react
    ├── angular-consumer-app
    └── react-consumer-app
```
- **component-library** - our core package and component library. Built with [StencilJS](https://stenciljs.com/)
- **component-library-angular** - Angular specific wrappers for our component library. We never update this package, the code inside is autogenerated by Stencil. More info [here](https://stenciljs.com/docs/overview)
- **component-library-react** - React specific wrappers for our component library. We never update this package, the code inside is autogenerated by Stencil. More info [here](https://stenciljs.com/docs/overview)
- **angular-consumer-app** - A simple Angular application where we can test integration between Angular and our component library
- **react-consumer-app** - A simple React application where we can test integration between React and our component library

### Getting started

Install all dependencies with yarn
```sh
yarn install
```

Since we have a monorepo where certain packages depend on each other, we need to link
them up by running the bootstrap command.

```sh
yarn bootstrap
```

To learn more about bootstraping and how packages are connected in a monorepo setup,
please read [here](https://lerna.js.org/docs/getting-started#bootstrapping-projects) and [here](https://lerna.js.org/docs/features/bootstrap).

### How to develop in this repo

Most of the development is done inside Storybook. Open up 2 terminals.

- In terminal 1 run `yarn start:component:library`
- In terminal 2 run `yarn storybook`

Navigate to `http://localhost:6006`, you will see Storybook. When you change your component code, Storybook will
pick up the changes and refresh.

### Other useful commands

Build all projects with yarn
```sh
yarn build
```

Build Storybook
```sh
yarn build-storybook
```

Run consumer apps to check for intergration
```sh
yarn start:consumer:apps
```

## Creating new components

To reduce the effort and minimize errors, there is a handy shell script that will generate a boilerplate component and story.

`./generate-component.sh my-new-component-name`

## Commit convention

We follow the [conventional commits](https://www.conventionalcommits.org/en/v1.0.0/).
The JIRA id from the task you are working on should also be included in the commit message.

It's important to follow the convention because publishing of the component library relies on the commit message format.
These messages will also end up in our changelog which will be added as a part of documentation.

What makes a good commit message?

- It's summarizes the changes to the reader and it tries to answer **what** and **why** questions
- Use 3rd person preferably
- Bullet points are fine if there are lots of changes
- If you are adding a new feature, please add a link to the documentation


Not so good commit messages:

- `Fixed bug`
- `finish update user`

Good commit messages based on our convention:

- `ci(SDK-123): automates deployment of react consumer app`
- `feat(SDK-345): [awesome-button-component](http://link-to-awesome-component.com)`
- `fix(SDK-111): fixes the navigation bar alignment on mobile`
- `docs(SDK-94): adds a section on commit convention in README`

We use [Husky](https://typicode.github.io/husky/#/) and [Commitlint](https://github.com/conventional-changelog/commitlint) to
ensure that messages are following the convention.
